{"version":3,"file":"khayyam-DaxfkgvX.js","sources":["../../src/sketches/khayyam.ts"],"sourcesContent":["import p5 from 'p5';\n\ninterface Particle {\n  position: p5.Vector;\n  velocity: p5.Vector;\n  acceleration: p5.Vector;\n  color: p5.Color;\n  size: number;\n  maxSpeed: number;\n  type: 'grape' | 'pebble' | 'sparkle' | 'wisdom';\n  opacity: number;\n  targetOpacity: number;\n  phase: number;\n  life: number;\n  maxLife: number;\n  rotation: number;\n  rotationSpeed: number;\n}\n\nconst sketch = (p: p5) => {\n  let particles: Particle[] = [];\n  let time = 0;\n  let moodPhase = 0;\n  let transformationProgress = 0;\n  \n  const createParticle = (x: number, y: number, type: Particle['type']): Particle => {\n    const baseColor = type === 'grape' ? p.color(180, 40, 60, 200) :\n                     type === 'pebble' ? p.color(200, 200, 200, 180) :\n                     type === 'sparkle' ? p.color(255, 215, 0, 150) :\n                     p.color(150, 100, 200, 180);\n\n    return {\n      position: p.createVector(x, y),\n      velocity: p.createVector(0, 0),\n      acceleration: p.createVector(0, 0),\n      color: baseColor,\n      size: type === 'grape' ? p.random(4, 6) :\n            type === 'pebble' ? p.random(3, 5) :\n            type === 'sparkle' ? p.random(2, 3) :\n            p.random(3, 4),\n      maxSpeed: type === 'grape' ? 2 :\n                type === 'pebble' ? 1.5 :\n                type === 'sparkle' ? 3 :\n                2,\n      type,\n      opacity: 0,\n      targetOpacity: type === 'sparkle' ? p.random(0.4, 0.6) :\n                    type === 'pebble' ? p.random(0.3, 0.5) :\n                    p.random(0.5, 0.7),\n      phase: p.random(p.TWO_PI),\n      life: 0,\n      maxLife: type === 'sparkle' ? p.random(100, 200) : Infinity,\n      rotation: p.random(p.TWO_PI),\n      rotationSpeed: p.random(-0.02, 0.02)\n    };\n  };\n\n  const createSparkle = (x: number, y: number) => {\n    const count = p.random(3, 6);\n    for (let i = 0; i < count; i++) {\n      const angle = p.random(p.TWO_PI);\n      const distance = p.random(10, 30);\n      const sparkleX = x + p.cos(angle) * distance;\n      const sparkleY = y + p.sin(angle) * distance;\n      particles.push(createParticle(sparkleX, sparkleY, 'sparkle'));\n    }\n  };\n\n  p.setup = () => {\n    const container = document.getElementById('sketch-container');\n    if (!container) {\n      console.error('Sketch container not found');\n      return;\n    }\n\n    const canvas = p.createCanvas(container.clientWidth, container.clientHeight);\n    canvas.parent('sketch-container');\n    p.background(0);\n    \n    // Initialize particles\n    const particleCount = 300;\n    const centerX = p.width / 2;\n    const centerY = p.height / 2;\n    const radius = Math.min(p.width, p.height) * 0.3;\n\n    // Create different types of particles\n    for (let i = 0; i < particleCount; i++) {\n      const type = i < particleCount * 0.4 ? 'pebble' :\n                  i < particleCount * 0.7 ? 'grape' :\n                  i < particleCount * 0.9 ? 'wisdom' : 'sparkle';\n      \n      const angle = (i / particleCount) * p.TWO_PI;\n      const distance = radius * p.random(0.8, 1.2);\n      const x = centerX + p.cos(angle) * distance;\n      const y = centerY + p.sin(angle) * distance;\n      \n      particles.push(createParticle(x, y, type));\n    }\n\n  };\n\n  p.draw = () => {\n    time += 0.01;\n    moodPhase = (moodPhase + 0.005) % p.TWO_PI;\n    transformationProgress = p.sin(moodPhase) * 0.5 + 0.5;\n    p.background(0, 0, 0, 0);\n\n    // Update and draw particles\n    particles = particles.filter(particle => {\n      // Update particle life\n      if (particle.type === 'sparkle') {\n        particle.life += 1;\n        if (particle.life > particle.maxLife) return false;\n      }\n\n      // Update rotation\n      particle.rotation += particle.rotationSpeed;\n\n      // Apply forces based on particle type\n      if (particle.type === 'pebble') {\n        const noise = p.noise(particle.position.x * 0.005, particle.position.y * 0.005, time * 0.5) * p.TWO_PI;\n        particle.acceleration.x = p.cos(noise) * 0.02;\n        particle.acceleration.y = p.sin(noise) * 0.02;\n        particle.opacity = p.lerp(particle.opacity, particle.targetOpacity * (1 - transformationProgress), 0.02);\n      } else if (particle.type === 'grape') {\n        particle.acceleration.y = -0.15 * transformationProgress;\n        particle.acceleration.x = p.sin(time + particle.phase) * 0.1 * transformationProgress;\n        particle.opacity = p.lerp(particle.opacity, particle.targetOpacity * transformationProgress, 0.03);\n      } else if (particle.type === 'wisdom') {\n        const centerForce = p5.Vector.sub(\n          p.createVector(p.width/2, p.height/2),\n          particle.position\n        ).mult(0.001);\n        particle.acceleration.add(centerForce);\n        particle.opacity = p.lerp(particle.opacity, particle.targetOpacity * transformationProgress, 0.02);\n      } else if (particle.type === 'sparkle') {\n        const lifeRatio = 1 - (particle.life / particle.maxLife);\n        particle.opacity = particle.targetOpacity * lifeRatio;\n        particle.acceleration.y -= 0.05;\n        particle.acceleration.x += p.sin(time * 2 + particle.phase) * 0.03;\n      }\n\n      // Apply mouse force\n      if (p.mouseX > 0 && p.mouseY > 0) {\n        const mousePos = p.createVector(p.mouseX, p.mouseY);\n        const force = p5.Vector.sub(particle.position, mousePos);\n        const distance = force.mag();\n        if (distance < 150) {\n          const strength = p.map(distance, 0, 150, 0.3, 0);\n          force.normalize();\n          force.mult(strength);\n          particle.acceleration.add(force);\n        }\n      }\n\n      // Update physics\n      particle.velocity.add(particle.acceleration);\n      particle.velocity.mult(0.98);\n      particle.velocity.limit(particle.maxSpeed);\n      particle.position.add(particle.velocity);\n      particle.acceleration.mult(0);\n\n      // Create sparkles for grapes during transformation\n      if (particle.type === 'grape' && transformationProgress > 0.5 && p.random() < 0.02) {\n        createSparkle(particle.position.x, particle.position.y);\n      }\n\n      // Draw particle\n      p.push();\n      p.translate(particle.position.x, particle.position.y);\n      p.rotate(particle.rotation);\n      \n      p.noStroke();\n      const alpha = particle.opacity * 255;\n      p.fill(p.red(particle.color), p.green(particle.color), p.blue(particle.color), alpha);\n      \n      if (particle.type === 'grape') {\n        p.drawingContext.shadowBlur = 10;\n        p.drawingContext.shadowColor = p.color(p.red(particle.color), p.green(particle.color), p.blue(particle.color), alpha * 0.5);\n        p.ellipse(0, 0, particle.size);\n      } else if (particle.type === 'pebble') {\n        p.rect(-particle.size/2, -particle.size/2, particle.size, particle.size, 2);\n      } else if (particle.type === 'sparkle') {\n        p.drawingContext.shadowBlur = 5;\n        p.drawingContext.shadowColor = p.color(255, 215, 0, alpha * 0.5);\n        p.ellipse(0, 0, particle.size);\n      } else {\n        p.drawingContext.shadowBlur = 8;\n        p.drawingContext.shadowColor = p.color(p.red(particle.color), p.green(particle.color), p.blue(particle.color), alpha * 0.5);\n        p.ellipse(0, 0, particle.size);\n      }\n      \n      p.drawingContext.shadowBlur = 0;\n      p.pop();\n\n      return true;\n    });\n  };\n\n  p.windowResized = () => {\n    const container = document.getElementById('sketch-container');\n    if (!container) return;\n\n    p.resizeCanvas(container.clientWidth, container.clientHeight);\n    particles = [];\n    p.setup();\n  };\n};\n\nnew p5(sketch); "],"names":["sketch","p","particles","time","moodPhase","transformationProgress","createParticle","x","y","type","baseColor","createSparkle","count","i","angle","distance","sparkleX","sparkleY","container","particleCount","centerX","centerY","radius","particle","noise","centerForce","p5","lifeRatio","mousePos","force","strength","alpha"],"mappings":"iEAmBA,MAAMA,EAAUC,GAAU,CACxB,IAAIC,EAAwB,CAAC,EACzBC,EAAO,EACPC,EAAY,EACZC,EAAyB,EAE7B,MAAMC,EAAiB,CAACC,EAAWC,EAAWC,IAAqC,CACjF,MAAMC,EAAYD,IAAS,QAAUR,EAAE,MAAM,IAAK,GAAI,GAAI,GAAG,EAC5CQ,IAAS,SAAWR,EAAE,MAAM,IAAK,IAAK,IAAK,GAAG,EAC9CQ,IAAS,UAAYR,EAAE,MAAM,IAAK,IAAK,EAAG,GAAG,EAC7CA,EAAE,MAAM,IAAK,IAAK,IAAK,GAAG,EAEpC,MAAA,CACL,SAAUA,EAAE,aAAaM,EAAGC,CAAC,EAC7B,SAAUP,EAAE,aAAa,EAAG,CAAC,EAC7B,aAAcA,EAAE,aAAa,EAAG,CAAC,EACjC,MAAOS,EACP,KAAMD,IAAS,QAAUR,EAAE,OAAO,EAAG,CAAC,EAChCQ,IAAS,SAAWR,EAAE,OAAO,EAAG,CAAC,EACjCQ,IAAS,UAAYR,EAAE,OAAO,EAAG,CAAC,EAClCA,EAAE,OAAO,EAAG,CAAC,EACnB,SAAUQ,IAAS,QAAU,EACnBA,IAAS,SAAW,IACpBA,IAAS,UAAY,EACrB,EACV,KAAAA,EACA,QAAS,EACT,cAAeA,IAAS,UAAYR,EAAE,OAAO,GAAK,EAAG,EACvCQ,IAAS,SAAWR,EAAE,OAAO,GAAK,EAAG,EACrCA,EAAE,OAAO,GAAK,EAAG,EAC/B,MAAOA,EAAE,OAAOA,EAAE,MAAM,EACxB,KAAM,EACN,QAASQ,IAAS,UAAYR,EAAE,OAAO,IAAK,GAAG,EAAI,IACnD,SAAUA,EAAE,OAAOA,EAAE,MAAM,EAC3B,cAAeA,EAAE,OAAO,KAAO,GAAI,CACrC,CACF,EAEMU,EAAgB,CAACJ,EAAWC,IAAc,CAC9C,MAAMI,EAAQX,EAAE,OAAO,EAAG,CAAC,EAC3B,QAASY,EAAI,EAAGA,EAAID,EAAOC,IAAK,CAC9B,MAAMC,EAAQb,EAAE,OAAOA,EAAE,MAAM,EACzBc,EAAWd,EAAE,OAAO,GAAI,EAAE,EAC1Be,EAAWT,EAAIN,EAAE,IAAIa,CAAK,EAAIC,EAC9BE,EAAWT,EAAIP,EAAE,IAAIa,CAAK,EAAIC,EACpCb,EAAU,KAAKI,EAAeU,EAAUC,EAAU,SAAS,CAAC,CAAA,CAEhE,EAEAhB,EAAE,MAAQ,IAAM,CACR,MAAAiB,EAAY,SAAS,eAAe,kBAAkB,EAC5D,GAAI,CAACA,EAAW,CACd,QAAQ,MAAM,4BAA4B,EAC1C,MAAA,CAGajB,EAAE,aAAaiB,EAAU,YAAaA,EAAU,YAAY,EACpE,OAAO,kBAAkB,EAChCjB,EAAE,WAAW,CAAC,EAGd,MAAMkB,EAAgB,IAChBC,EAAUnB,EAAE,MAAQ,EACpBoB,EAAUpB,EAAE,OAAS,EACrBqB,EAAS,KAAK,IAAIrB,EAAE,MAAOA,EAAE,MAAM,EAAI,GAG7C,QAASY,EAAI,EAAGA,EAAIM,EAAeN,IAAK,CACtC,MAAMJ,EAAOI,EAAIM,EAAgB,GAAM,SAC3BN,EAAIM,EAAgB,GAAM,QAC1BN,EAAIM,EAAgB,GAAM,SAAW,UAE3CL,EAASD,EAAIM,EAAiBlB,EAAE,OAChCc,EAAWO,EAASrB,EAAE,OAAO,GAAK,GAAG,EACrCM,EAAIa,EAAUnB,EAAE,IAAIa,CAAK,EAAIC,EAC7BP,EAAIa,EAAUpB,EAAE,IAAIa,CAAK,EAAIC,EAEnCb,EAAU,KAAKI,EAAeC,EAAGC,EAAGC,CAAI,CAAC,CAAA,CAG7C,EAEAR,EAAE,KAAO,IAAM,CACLE,GAAA,IACKC,GAAAA,EAAY,MAASH,EAAE,OACpCI,EAAyBJ,EAAE,IAAIG,CAAS,EAAI,GAAM,GAClDH,EAAE,WAAW,EAAG,EAAG,EAAG,CAAC,EAGXC,EAAAA,EAAU,OAAmBqB,GAAA,CAEnC,GAAAA,EAAS,OAAS,YACpBA,EAAS,MAAQ,EACbA,EAAS,KAAOA,EAAS,SAAgB,MAAA,GAO3C,GAHJA,EAAS,UAAYA,EAAS,cAG1BA,EAAS,OAAS,SAAU,CAC9B,MAAMC,EAAQvB,EAAE,MAAMsB,EAAS,SAAS,EAAI,KAAOA,EAAS,SAAS,EAAI,KAAOpB,EAAO,EAAG,EAAIF,EAAE,OAChGsB,EAAS,aAAa,EAAItB,EAAE,IAAIuB,CAAK,EAAI,IACzCD,EAAS,aAAa,EAAItB,EAAE,IAAIuB,CAAK,EAAI,IAChCD,EAAA,QAAUtB,EAAE,KAAKsB,EAAS,QAASA,EAAS,eAAiB,EAAIlB,GAAyB,GAAI,CAAA,SAC9FkB,EAAS,OAAS,QAClBA,EAAA,aAAa,EAAI,KAAQlB,EACzBkB,EAAA,aAAa,EAAItB,EAAE,IAAIE,EAAOoB,EAAS,KAAK,EAAI,GAAMlB,EACtDkB,EAAA,QAAUtB,EAAE,KAAKsB,EAAS,QAASA,EAAS,cAAgBlB,EAAwB,GAAI,UACxFkB,EAAS,OAAS,SAAU,CAC/B,MAAAE,EAAcC,EAAG,OAAO,IAC5BzB,EAAE,aAAaA,EAAE,MAAM,EAAGA,EAAE,OAAO,CAAC,EACpCsB,EAAS,QAAA,EACT,KAAK,IAAK,EACHA,EAAA,aAAa,IAAIE,CAAW,EAC5BF,EAAA,QAAUtB,EAAE,KAAKsB,EAAS,QAASA,EAAS,cAAgBlB,EAAwB,GAAI,CAAA,SACxFkB,EAAS,OAAS,UAAW,CACtC,MAAMI,EAAY,EAAKJ,EAAS,KAAOA,EAAS,QACvCA,EAAA,QAAUA,EAAS,cAAgBI,EAC5CJ,EAAS,aAAa,GAAK,IAClBA,EAAA,aAAa,GAAKtB,EAAE,IAAIE,EAAO,EAAIoB,EAAS,KAAK,EAAI,GAAA,CAIhE,GAAItB,EAAE,OAAS,GAAKA,EAAE,OAAS,EAAG,CAChC,MAAM2B,EAAW3B,EAAE,aAAaA,EAAE,OAAQA,EAAE,MAAM,EAC5C4B,EAAQH,EAAG,OAAO,IAAIH,EAAS,SAAUK,CAAQ,EACjDb,EAAWc,EAAM,IAAI,EAC3B,GAAId,EAAW,IAAK,CAClB,MAAMe,EAAW7B,EAAE,IAAIc,EAAU,EAAG,IAAK,GAAK,CAAC,EAC/Cc,EAAM,UAAU,EAChBA,EAAM,KAAKC,CAAQ,EACVP,EAAA,aAAa,IAAIM,CAAK,CAAA,CACjC,CAION,EAAA,SAAS,IAAIA,EAAS,YAAY,EAClCA,EAAA,SAAS,KAAK,GAAI,EAClBA,EAAA,SAAS,MAAMA,EAAS,QAAQ,EAChCA,EAAA,SAAS,IAAIA,EAAS,QAAQ,EAC9BA,EAAA,aAAa,KAAK,CAAC,EAGxBA,EAAS,OAAS,SAAWlB,EAAyB,IAAOJ,EAAE,SAAW,KAC5EU,EAAcY,EAAS,SAAS,EAAGA,EAAS,SAAS,CAAC,EAIxDtB,EAAE,KAAK,EACPA,EAAE,UAAUsB,EAAS,SAAS,EAAGA,EAAS,SAAS,CAAC,EAClDtB,EAAA,OAAOsB,EAAS,QAAQ,EAE1BtB,EAAE,SAAS,EACL,MAAA8B,EAAQR,EAAS,QAAU,IACjC,OAAAtB,EAAE,KAAKA,EAAE,IAAIsB,EAAS,KAAK,EAAGtB,EAAE,MAAMsB,EAAS,KAAK,EAAGtB,EAAE,KAAKsB,EAAS,KAAK,EAAGQ,CAAK,EAEhFR,EAAS,OAAS,SACpBtB,EAAE,eAAe,WAAa,GAC5BA,EAAA,eAAe,YAAcA,EAAE,MAAMA,EAAE,IAAIsB,EAAS,KAAK,EAAGtB,EAAE,MAAMsB,EAAS,KAAK,EAAGtB,EAAE,KAAKsB,EAAS,KAAK,EAAGQ,EAAQ,EAAG,EAC1H9B,EAAE,QAAQ,EAAG,EAAGsB,EAAS,IAAI,GACpBA,EAAS,OAAS,SAC3BtB,EAAE,KAAK,CAACsB,EAAS,KAAK,EAAG,CAACA,EAAS,KAAK,EAAGA,EAAS,KAAMA,EAAS,KAAM,CAAC,EACjEA,EAAS,OAAS,WAC3BtB,EAAE,eAAe,WAAa,EAC5BA,EAAA,eAAe,YAAcA,EAAE,MAAM,IAAK,IAAK,EAAG8B,EAAQ,EAAG,EAC/D9B,EAAE,QAAQ,EAAG,EAAGsB,EAAS,IAAI,IAE7BtB,EAAE,eAAe,WAAa,EAC5BA,EAAA,eAAe,YAAcA,EAAE,MAAMA,EAAE,IAAIsB,EAAS,KAAK,EAAGtB,EAAE,MAAMsB,EAAS,KAAK,EAAGtB,EAAE,KAAKsB,EAAS,KAAK,EAAGQ,EAAQ,EAAG,EAC1H9B,EAAE,QAAQ,EAAG,EAAGsB,EAAS,IAAI,GAG/BtB,EAAE,eAAe,WAAa,EAC9BA,EAAE,IAAI,EAEC,EAAA,CACR,CACH,EAEAA,EAAE,cAAgB,IAAM,CAChB,MAAAiB,EAAY,SAAS,eAAe,kBAAkB,EACvDA,IAELjB,EAAE,aAAaiB,EAAU,YAAaA,EAAU,YAAY,EAC5DhB,EAAY,CAAC,EACbD,EAAE,MAAM,EACV,CACF,EAEA,IAAIyB,EAAG1B,CAAM"}